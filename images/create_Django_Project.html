<hr>
<p>title: Python3 - 创建并配置Django项目<br>date: 2018-05-24 10:31:15<br>author: Zoie<br>tags:</p>
<ul>
<li>创建项目<br>categories: </li>
<li>Django</li>
</ul>
<hr>
<h2 id="一、创建Django项目"><a href="#一、创建Django项目" class="headerlink" title="一、创建Django项目"></a>一、创建Django项目</h2><p>​                                                                                                                                                                                      </p>
<blockquote>
<h3 id="用命令行创建Django项目"><a href="#用命令行创建Django项目" class="headerlink" title="用命令行创建Django项目"></a>用命令行创建Django项目</h3></blockquote>
<p><strong>1. Windows环境</strong></p>
<pre><code class="bash">1. 创建虚拟环境, 目录名venv
    $ python -m venv venv  
2. 查看虚拟目录
    $ <span class="built_in">cd</span> venv 
3. 激活虚拟环境
    $ <span class="built_in">cd</span> Scripts 切换到脚本
    $ activate 激活虚拟环境 
4. 在虚拟环境安装django并指定版本号(最新版不用指定)
    $ pip install django[==版本号] 
5. 查看django版本(可跳过此步骤)
    $ django-admin --version
6. 开启一个项目
    $ django-admin startproject hello_django .
</code></pre>
<p><strong>2. MAC / Linux 环境</strong></p>
<pre><code class="bash">1. 创建项目文件夹
    $ mkdir hello_django
2. 切换到项目目录
    $ <span class="built_in">cd</span> hello_django/
3. 使用venv模块创建虚拟环境，目录名venv
    <span class="comment"># pythonX 早期版本建虚拟环境</span>
    <span class="comment">#    $pip install virtualenv</span>
    <span class="comment"># pythonX -m irtualenv venv</span>
    $ python3 -m venv venv
4. 激活虚拟环境
    $ <span class="built_in">source</span> venv/bin/activate
5. 更新pip到最新版本(如果已经是最新版则跳过次步)
    $ python -m pip install --upgrade pip
6. 使用pip安装django
    $ pip install django[==版本号]
7. 通过安装django时安装的脚本工具django-admin检查django版本(可跳过此步骤)
    $ django-admin --version
8. 开启一个项目
    $ django-admin startproject hello_django .
</code></pre>
<blockquote>
<h3 id="使用pycharm创建Django项目"><a href="#使用pycharm创建Django项目" class="headerlink" title="使用pycharm创建Django项目"></a>使用pycharm创建Django项目</h3></blockquote>
<ol>
<li><p>点击Create New Project 创建一个新项目<br><img src="/../images/1.jpg" alt="1"><br><br></p>
</li>
<li><p>点击 Django → 选择项目存储路径<br>如果想在创建项目是新建一个应用, 点击More Setting, 输入应用的名称</p>
<p>点击 右下角Greate, 创建项目<br>  <img src="/../images/2.jpg" alt="2"></p>
</li>
</ol>
<p><br></p>
<h2 id="二、配置Django项目"><a href="#二、配置Django项目" class="headerlink" title="二、配置Django项目"></a>二、配置Django项目</h2><p><strong>1. 创建一个名为cars的应用</strong></p>
<p>  python manager.py startapp cars</p>
<p>   setting.py</p>
<pre><code class="python"><span class="comment"># 添加应用配置</span>
<span class="comment"># 每新建一个应用就要添加一个</span>
INSTALLED_APPS = [
    <span class="string">'cars.apps.CarsConfig'</span>,
]
</code></pre>
<p><strong>2. 创建数据库</strong></p>
<p>   创建名为cars的数据库, 并指定utf8字符集</p>
<p><strong>3. 配置数据库</strong></p>
<p>   settings.py</p>
<pre><code class="python">DATABASES = {
    <span class="string">'default'</span>: {
        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,
        <span class="string">'NAME'</span>: <span class="string">'cars'</span>, <span class="comment"># 与数据库名称对应</span>
        <span class="string">'HOST'</span>: <span class="string">'localhost'</span>,
        <span class="string">'PORT'</span>: <span class="number">3306</span>,
        <span class="string">'USER'</span>: <span class="string">'root'</span>,
        <span class="string">'PASSWORD'</span>: <span class="string">'root'</span>,
    }
}
</code></pre>
<p>   |—  cars</p>
<pre><code>|—  _\_init\_\_.py
</code></pre><pre><code class="python"><span class="keyword">import</span> pymysql
<span class="comment">#把pymysql方式当成是mysqldb一样使用</span>
pymysql.install_as_MySQLdb()
</code></pre>
<p><strong>4. 创建模型</strong></p>
<p>models.py</p>
<pre><code class="python"><span class="keyword">from</span> django.db <span class="keyword">import</span> models

<span class="class"><span class="keyword">class</span> <span class="title">Record</span><span class="params">(models.Model)</span>:</span>

    no = models.AutoField(primary_key=<span class="keyword">True</span>,verbose_name=<span class="string">'编号'</span>)
    car_no = models.CharField(max_length=<span class="number">7</span>, verbose_name=<span class="string">'车牌号'</span>)
    cause = models.CharField(max_length=<span class="number">100</span>, verbose_name=<span class="string">'违章原因'</span>)
    date = models.DateTimeField(auto_now_add=<span class="keyword">True</span>, verbose_name=<span class="string">'违章日期'</span>,db_column=<span class="string">'happen_date'</span>)
    way = models.CharField(max_length=<span class="number">100</span>, verbose_name=<span class="string">'处罚方式'</span>)
    dispose = models.BooleanField(default=<span class="keyword">False</span>, verbose_name=<span class="string">'是否受理'</span>)

<span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span>
    db_table = <span class="string">'tb_car_record'</span>
    verbose_name_plural = <span class="string">'违章记录'</span>
    ordering = (<span class="string">'no'</span>, )
</code></pre>
<p><strong>6. 迁移数据库</strong></p>
<p>  $ python manage.py makemigrations hrs # 生成迁移<br>  $ python manage.py migrate # 执行迁移</p>
<p><strong>7. 创建管理员</strong></p>
<p>   $ python manage.py createsuperuser<br>   配置 Username / Email address / Password</p>
<p><strong>8. 配置管理员界面</strong></p>
<p>   admin.py</p>
<pre><code class="python"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin
<span class="keyword">from</span> cars.models <span class="keyword">import</span> Record

<span class="class"><span class="keyword">class</span> <span class="title">RecordAdmin</span><span class="params">(admin.ModelAdmin)</span>:</span>
    <span class="comment"># 添加管理员页面要显示的列</span>
    list_display = (<span class="string">'no'</span>, <span class="string">'car_no'</span>, <span class="string">'cause'</span>, <span class="string">'date'</span>, <span class="string">'way'</span>, <span class="string">'dispose'</span>)
    <span class="comment"># 指定搜索列</span>
    search_fields = (<span class="string">'car_no'</span>,)
    <span class="comment"># 指定排序方式</span>
    ordering = (<span class="string">'no'</span>,)

admin.site.register(Record, RecordAdmin)
</code></pre>
<p><strong>9. 创建视图文件夹 templates / 静态文件夹 static (与应用/项目目录同级)</strong></p>
<p>   |—  cars</p>
<p>   |—  static (存放静态文件 css / js / jQuery)</p>
<p>   |—  templates (存放html页面, 使用pycharm创建项目会自动添加)</p>
<p>   setting.py</p>
<pre><code class="python"><span class="comment"># 添加static文件夹路径</span>
STATICFILES_DIRS = [os.path.join(BASE_DIR, <span class="string">'static'</span>)]
</code></pre>
<p>   如果使用命令行创建Django项目</p>
<p>   还需要在setting.py中添加如下配置:        </p>
<p>   ​     ‘DIRS’: [os.path.join(BASE_DIR, ‘templates’)]</p>
<pre><code class="python">TEMPLATES = [
    {
        <span class="string">'BACKEND'</span>: <span class="string">'django.template.backends.django.DjangoTemplates'</span>,
        <span class="comment"># 添加templates文件夹路径</span>
        <span class="string">'DIRS'</span>: [os.path.join(BASE_DIR, <span class="string">'templates'</span>)]
        ,
        <span class="string">'APP_DIRS'</span>: <span class="keyword">True</span>,
        <span class="string">'OPTIONS'</span>: {
            <span class="string">'context_processors'</span>: [
                <span class="string">'django.template.context_processors.debug'</span>,
                <span class="string">'django.template.context_processors.request'</span>,
                <span class="string">'django.contrib.auth.context_processors.auth'</span>,
                <span class="string">'django.contrib.messages.context_processors.messages'</span>,
            ],
        },
    },
]
</code></pre>
